<!doctype html>
<html lang="en">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<title>Canvas Cycle MX</title>
		<meta http-equiv="X-UA-Compatible" content="chrome=1" />
		<link rel="stylesheet" type="text/css" href="style.css" />
		<script type="text/javascript" src="oop.js"></script>
		<script type="text/javascript" src="tools.js"></script>
		<script type="text/javascript" src="cookie.js"></script>
		<script type="text/javascript" src="palette.js"></script>
		<script type="text/javascript" src="bitmap.js"></script>
		<script type="text/javascript" src="scenes.js"></script>
		<script type="text/javascript" src="tween.js"></script>
		<script type="text/javascript" src="framecount.js"></script>
		<script type="text/javascript" src="lib/pako.min.js"></script>
		<script type="text/javascript" src="lib/upng.js"></script>
		<script type="text/javascript" src="main.js"></script>
	</head>
	<body class="large_palette">
		<div id="top_menubar">
			<div id="app_menu_wrap" class="menu-wrap">
				<button id="btn_app_menu" class="menu-trigger" type="button">
					canvascycle-mx
				</button>
				<div id="app_menu" class="popup-menu hidden">
					<div id="menu_about_app" class="menu-item">About canvascycle-mx...</div>
				</div>
			</div>
			<div id="file_menu_wrap" class="menu-wrap">
				<button id="btn_file_menu" class="menu-trigger" type="button">
					File
				</button>
				<div id="file_menu" class="popup-menu hidden">
					<div id="menu_open_sample" class="menu-item has-submenu">
						<span>Open Sample</span><span class="arrow">‚Ä∫</span>
						<div id="sample_submenu" class="submenu">
							<div id="d_scene_selector"></div>
						</div>
					</div>
					<hr />
					<label id="menu_upload_png" class="menu-item upload-item"
						>Import PNG<input
							id="fe_upload_png"
							type="file"
							accept=".png,image/png"
					/></label>
					<label id="menu_upload_json" class="menu-item upload-item"
						>Import JSON<input
							id="fe_upload_json"
							type="file"
							accept=".json,application/json"
					/></label>
					<hr />
					<div id="menu_export_json" class="menu-item">Export JSON</div>
					<div id="menu_export_embed" class="menu-item">Export Embed</div>
				</div>
			</div>
			<div id="edit_menu_wrap" class="menu-wrap">
				<button id="btn_edit_menu" class="menu-trigger" type="button">
					Edit
				</button>
				<div id="edit_menu" class="popup-menu hidden">
					<div id="menu_undo" class="menu-item menu-item-disabled">Undo</div>
				</div>
			</div>
			<div id="help_menu_wrap" class="menu-wrap">
				<button id="btn_help_menu" class="menu-trigger" type="button">
					Help
				</button>
				<div id="help_menu" class="popup-menu hidden">
					<div id="menu_help_app" class="menu-item">canvascycle-mx Help...</div>
				</div>
			</div>
		</div>

		<div id="container">
			<div id="palette-column">
				<div id="d_options">
					<div id="palette_display"></div>
					<div id="d_debug"></div>
				</div>
			</div>

			<div id="image-column">
				<div id="d_canvas_row">
					<canvas id="mycanvas" width="640" height="480"></canvas>
					<div id="d_loading"></div>
					<div class="clear"></div>
				</div>

				<div id="d_cycles_row" class="section">
					<!-- <div class="label">CYCLES:</div> -->
					<div id="cycles_header" class="cycle_header">
						<div class="cycle_col"></div>
						<div
							id="add_cycle"
							class="button left right"
							onClick="CC.addCycle()"
						>
							+
						</div>
						<!-- <div class="cycle_id"></div> -->
						<div class="cycle_col">Low</div>
						<div class="cycle_col">High</div>
						<div class="cycle_col">Rate</div>
						<div class="cycle_col">Direction</div>
					</div>
					<div id="cycles_editor"></div>
					<!-- <div id="cycles_toolbar">
            <div class="button left right" onClick="CC.addCycle()">
              + Add Cycle
            </div>
          </div> -->
				</div>
			</div>

			<div id="cycle_palette" class="tool-palette">
				<div class="palette-grip" title="Drag palette"></div>
				<div class="palette-row">
					<div class="speed-row">
						<button
							id="btn_speed_025"
							class="button thin"
							title="Speed 1/4x"
							onClick="CC.setSpeed(0.25)"
						>
							&frac14;
						</button>
						<button
							id="btn_speed_05"
							class="button thin"
							title="Speed 1/2x"
							onClick="CC.setSpeed(0.5)"
						>
							&frac12;
						</button>
						<button
							id="btn_speed_1"
							class="button thin selected"
							title="Speed 1x"
							onClick="CC.setSpeed(1)"
						>
							1
						</button>
						<button
							id="btn_speed_2"
							class="button thin"
							title="Speed 2x"
							onClick="CC.setSpeed(2)"
						>
							2
						</button>
						<button
							id="btn_speed_4"
							class="button thin"
							title="Speed 4x"
							onClick="CC.setSpeed(4)"
						>
							4
						</button>
					</div>
					<button
						id="btn_blend_shift"
						class="button icon-btn blend-btn-icon selected"
						title="Blend shift"
						aria-label="Blend shift"
						aria-pressed="true"
						onClick="CC.toggleBlendShift()"
					>
						‚óê
					</button>
					<button
						id="btn_palette_sort"
						class="button icon-btn"
						title="Sort Palette"
						onClick="CC.togglePaletteSortPopup(event)"
					>
						‚áÖ
					</button>
					<button
						id="btn_cycle_reset"
						class="button icon-btn"
						title="Reset Cycle Animation"
						onClick="CC.resetCycleAnimation()"
					>
						‚Ü∫
					</button>
					<button
						id="btn_pause"
						class="button icon-btn"
						title="Pause"
						onClick="CC.togglePlayback()"
					>
						‚è∏
					</button>
				</div>
			</div>
			<div id="palette_sort_popup" class="popup-menu hidden">
				<div class="menu-item" data-sort="reverse">Reverse colors</div>
				<hr />
				<div class="menu-item" data-sort="hue">Sort by hue</div>
				<div class="menu-item" data-sort="saturation">Sort by saturation</div>
				<div class="menu-item" data-sort="brightness">Sort by brightness</div>
				<div class="menu-item" data-sort="luminance">Sort by luminance</div>
				<hr />
				<div class="menu-item" data-sort="red">Sort by red</div>
				<div class="menu-item" data-sort="green">Sort by green</div>
				<div class="menu-item" data-sort="blue">Sort by blue</div>
			</div>

			<div id="image_palette" class="tool-palette">
				<div class="palette-grip" title="Drag palette"></div>
				<button
					class="tool-btn"
					id="tool_zoom"
					title="Zoom"
					onClick="CC.setTool('zoom')"
				>
					üîç
				</button>
				<button
					class="tool-btn"
					id="tool_pencil"
					title="Pencil"
					onClick="CC.setTool('pencil')"
				>
					‚úé
				</button>
				<button
					class="tool-btn"
					id="tool_eyedropper"
					title="Eyedropper"
					onClick="CC.setTool('eyedropper')"
				>
					üß™
				</button>
				<button
					class="tool-btn"
					id="tool_move"
					title="Move"
					onClick="CC.setTool('move')"
				>
					‚úã
				</button>
				<hr />
				<button
					class="tool-btn"
					id="tool_grid"
					title="Toggle Pixel Grid"
					onClick="CC.toggleGridOverlay()"
				>
					‚ñ¶
				</button>
				<button
					class="tool-btn"
					id="tool_reset"
					title="Reset View"
					onClick="CC.resetView()"
				>
					‚Üª
				</button>
				<button
					class="tool-chip"
					id="tool_color_chip"
					title="Current color"
				></button>
				<div id="color_chip_popup" class="hidden"></div>
			</div>
		</div>

		<div id="palette_sort_warning_modal" class="modal hidden">
			<div class="modal-card">
				<p>WARNING: reordering the palette will delete cycle data.</p>
				<div class="modal-actions">
					<button
						class="button"
						type="button"
						onClick="CC.cancelPaletteSortWarning()"
					>
						Cancel
					</button>
					<button
						class="button default-action"
						type="button"
						onClick="CC.confirmPaletteSortWarning()"
					>
						Proceed
					</button>
				</div>
			</div>
		</div>

		<div id="scene_modal" class="modal hidden">
			<div class="modal-card">
				<p>Edits to the current image will be lost.</p>
				<div class="modal-actions">
					<button class="button" type="button" onClick="CC.modalExportJSON()">
						Export JSON
					</button>
					<button class="button" type="button" onClick="CC.cancelSceneSwitch()">
						Cancel
					</button>
					<button
						class="button default-action"
						type="button"
						onClick="CC.confirmSceneSwitch()"
						autofocus
					>
						Open Selection
					</button>
				</div>
			</div>
		</div>

		<div id="about_modal" class="modal hidden">
			<div class="modal-card modal-card-scrollable">
				<div class="modal-header">
					<h2>About canvascycle-mx</h2>
					<button class="button" type="button" onClick="CC.closeAboutModal()">Close</button>
				</div>
				<div class="modal-scroll-area">
					<p>This area is reserved for About content. You can replace this with your own HTML.</p>
					<p>Lorem ipsum placeholder text to demonstrate scroll behavior.</p>
					<p>Lorem ipsum placeholder text to demonstrate scroll behavior.</p>
					<p>Lorem ipsum placeholder text to demonstrate scroll behavior.</p>
					<p>Lorem ipsum placeholder text to demonstrate scroll behavior.</p>
					<p>Lorem ipsum placeholder text to demonstrate scroll behavior.</p>
				</div>
			</div>
		</div>

		<div id="help_modal" class="modal hidden">
			<div class="modal-card modal-card-scrollable">
				<div class="modal-header">
					<h2>canvascycle-mx Help</h2>
					<button class="button" type="button" onClick="CC.closeHelpModal()">Close</button>
				</div>
				<div class="modal-scroll-area help-content">
					<h3>Image Tool Palette</h3>
					<div class="help-tool-list">
						<div class="help-tool-row"><span class="help-tool-icon">üîç</span><div><strong>Zoom</strong><p>Use Zoom to inspect details and focus your edits at different magnifications.</p></div></div>
						<div class="help-tool-row"><span class="help-tool-icon">‚úé</span><div><strong>Pencil</strong><p>Use Pencil to paint with the active palette color directly onto the image.</p></div></div>
						<div class="help-tool-row"><span class="help-tool-icon">üß™</span><div><strong>Eyedropper</strong><p>Use Eyedropper to sample a color from the image or palette and set it as active.</p></div></div>
						<div class="help-tool-row"><span class="help-tool-icon">‚úã</span><div><strong>Move</strong><p>Use Move to pan around the canvas while zoomed in.</p></div></div>
						<div class="help-tool-row"><span class="help-tool-icon">‚ñ¶</span><div><strong>Toggle Pixel Grid</strong><p>Show or hide the pixel grid overlay for precision editing.</p></div></div>
						<div class="help-tool-row"><span class="help-tool-icon">‚Üª</span><div><strong>Reset View</strong><p>Reset zoom and pan to the default framing.</p></div></div>
					</div>

					<h3>Color Data</h3>
					<p>The color data palette shows all indexed colors. You can inspect, select, and reorganize palette entries to control how cycling affects the image.</p>

					<h3>Cycle Palette</h3>
					<div class="help-tool-list">
						<div class="help-tool-row"><span class="help-tool-icon"><span class="help-mini-btn selected">¬Ω</span></span><div><strong>Speed</strong><p>Set animation speed using the grouped speed buttons (¬º, ¬Ω, 1, 2, 4).</p></div></div>
						<div class="help-tool-row"><span class="help-tool-icon">‚óê</span><div><strong>Blend Shift</strong><p>Toggle blended transitions between cycle steps.</p></div></div>
						<div class="help-tool-row"><span class="help-tool-icon">‚áÖ</span><div><strong>Sort Palette</strong><p>Reorder colors using common sorting modes.</p></div></div>
						<div class="help-tool-row"><span class="help-tool-icon">‚Ü∫</span><div><strong>Reset Cycle Animation</strong><p>Restart cycle playback timing from the beginning.</p></div></div>
						<div class="help-tool-row"><span class="help-tool-icon">‚è∏</span><div><strong>Pause / Resume</strong><p>Pause or resume playback.</p></div></div>
					</div>

					<h3>Cycle Data</h3>
					<div class="help-tool-list">
						<div class="help-tool-row"><span class="help-tool-icon">Ôºã</span><div><strong>Add Cycle</strong><p>Add a new cycle row for defining animated color ranges.</p></div></div>
						<div class="help-tool-row"><span class="help-tool-icon">‚Üï</span><div><strong>Direction</strong><p>Choose how the cycle range moves: 0 = forward, 1 = forward (legacy-compatible alias), 2 = reverse.</p></div></div>
						<div class="help-tool-row"><span class="help-tool-icon">‚¨á‚¨Ü</span><div><strong>Low / High</strong><p>Set the starting and ending palette indexes that define the cycle range for that row.</p></div></div>
						<div class="help-tool-row"><span class="help-tool-icon">‚ö°</span><div><strong>Rate</strong><p>Controls how fast the cycle shifts colors over time. Larger values produce faster animation.</p></div></div>
						<div class="help-tool-row"><span class="help-tool-icon">‚òë</span><div><strong>Active</strong><p>Use the checkbox to enable or disable the cycle row without deleting it.</p></div></div>
						<div class="help-tool-row"><span class="help-tool-icon">‚úï</span><div><strong>Delete</strong><p>Click the delete button to remove that cycle row.</p></div></div>
					</div>

					<h3>Import</h3>
					<p><strong>Import PNG:</strong> Import an indexed PNG and convert it into canvascycle JSON data (pixels, palette, and cycle-ready structure).</p>
					<p><strong>Import JSON:</strong> Load a previously exported canvascycle JSON file to continue editing.</p>

					<h3>Export</h3>
					<p><strong>Export JSON:</strong> Save the current image, palette, and cycle data as a standard JSON file.</p>
					<p><strong>Export Embeddable JSON:</strong> Save a compact/embeddable variant for web playback integrations.</p>

					<h3>Player</h3>
					<p><strong>Standalone player script:</strong> Use the player script to load and play a JSON data file without the editor UI. <a href="src/player-core.js" download>Download standalone player script</a>.</p>
					<p><strong>Standalone embeddable JSON:</strong> This export is self-executing. Embed it directly in any HTML page with a <code>&lt;script&gt;</code> tag&mdash;no separate player pairing is required.</p>
				</div>
			</div>
		</div>

		<script>
			if (document.addEventListener) {
				document.addEventListener(
					"DOMContentLoaded",
					function () {
						CC.init();
					},
					false,
				);
				window.addEventListener(
					"resize",
					function () {
						CC.handleResize();
					},
					false,
				);
			}
		</script>
	</body>
</html>
